(()=>{var F={};try{F.WeakMap=WeakMap}catch(t){F.WeakMap=function(e,r){"use strict";var n=r.defineProperty,s=r.hasOwnProperty,a=i.prototype;return a.delete=function(o){return this.has(o)&&delete o[this._]},a.get=function(o){return this.has(o)?o[this._]:void 0},a.has=function(o){return s.call(o,this._)},a.set=function(o,c){return n(o,this._,{configurable:!0,value:c}),this},i;function i(o){n(this,"_",{value:"_@ungap/weakmap"+e++}),o&&o.forEach(f,this)}function f(o){this.set(o[0],o[1])}}(Math.random(),Object)}var k=F.WeakMap;var g="-"+Math.random().toFixed(6)+"%",j=!1;try{(function(t,e,r){return e in t&&(t.innerHTML="<p "+r+'="'+g+'"></p>',t[e].childNodes[0].getAttribute(r)==g)})(document.createElement("template"),"content","tabindex")||(g="_dt: "+g.slice(1,-1)+";",j=!0)}catch(t){}var S="<!--"+g+"-->",V=8,tt=1,et=3,W=/^(?:style|textarea)$/i,rt=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i;function q(t){return t.join(S).replace(Ut,Rt).replace(Pt,zt)}var I=" \\f\\n\\r\\t",nt="[^"+I+`\\/>"'=]+`,B="["+I+"]+"+nt,it="<([A-Za-z]+[A-Za-z0-9:._-]*)((?:",ot=`(?:\\s*=\\s*(?:'[^']*?'|"[^"]*?"|<[^>]*?>|`+nt.replace("\\/","")+"))?)",Pt=new RegExp(it+B+ot+"+)(["+I+"]*/?>)","g"),Ut=new RegExp(it+B+ot+"*)(["+I+"]*/>)","g"),Ht=new RegExp("("+B+`\\s*=\\s*)(['"]?)`+S+"\\2","gi");function zt(t,e,r,n){return"<"+e+r.replace(Ht,Ft)+n}function Ft(t,e,r){return e+(r||'"')+g+(r||'"')}function Rt(t,e,r){return rt.test(e)?t:"<"+e+r+"></"+e+">"}var{isArray:d}=Array,{indexOf:be,slice:x}=[],M=t=>({get:e=>t.get(e),set:(e,r)=>(t.set(e,r),r)}),Wt=1,st=111,qt=({firstChild:t,lastChild:e})=>{let r=document.createRange();return r.setStartAfter(t),r.setEndAfter(e),r.deleteContents(),t},b=(t,e)=>t.nodeType===st?1/e<0?e?qt(t):t.lastChild:e?t.valueOf():t.firstChild:t,at=t=>{let{childNodes:e}=t,{length:r}=e;if(r<2)return r?e[0]:t;let n=x.call(e,0),s=n[0],a=n[r-1];return{ELEMENT_NODE:Wt,nodeType:st,firstChild:s,lastChild:a,valueOf(){if(e.length!==r){let i=0;for(;i<r;)t.appendChild(n[i++])}return t}}};var Bt=function(t){"use strict";var e="fragment",r="template",n="content"in i(r),s=n?function(o){var c=i(r);return c.innerHTML=o,c.content}:function(o){var c=i(e),l=i(r),u=null;if(/^[^\S]*?<(col(?:group)?|t(?:head|body|foot|r|d|h))/i.test(o)){var p=RegExp.$1;l.innerHTML="<table>"+o+"</table>",u=l.querySelectorAll(p)}else l.innerHTML=o,u=l.childNodes;return a(c,u),c};return function(c,l){return(l==="svg"?f:s)(c)};function a(o,c){for(var l=c.length;l--;)o.appendChild(c[0])}function i(o){return o===e?t.createDocumentFragment():t.createElementNS("http://www.w3.org/1999/xhtml",o)}function f(o){var c=i(e),l=i("div");return l.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+o+"</svg>",a(c,l.firstChild.childNodes),c}}(document),P=Bt,E=(t,e,r,n,s)=>{let a=r.length,i=e.length,f=a,o=0,c=0,l=null;for(;o<i||c<f;)if(i===o){let u=f<a?c?n(r[c-1],-0).nextSibling:n(r[f-c],0):s;for(;c<f;)t.insertBefore(n(r[c++],1),u)}else if(f===c)for(;o<i;)(!l||!l.has(e[o]))&&t.removeChild(n(e[o],-1)),o++;else if(e[o]===r[c])o++,c++;else if(e[i-1]===r[f-1])i--,f--;else if(e[o]===r[f-1]&&r[c]===e[i-1]){let u=n(e[--i],-1).nextSibling;t.insertBefore(n(r[c++],1),n(e[o++],-1).nextSibling),t.insertBefore(n(r[--f],1),u),e[i]=r[f]}else{if(!l){l=new Map;let u=c;for(;u<f;)l.set(r[u],u++)}if(l.has(e[o])){let u=l.get(e[o]);if(c<u&&u<f){let p=o,h=1;for(;++p<i&&p<f&&l.get(e[p])===u+h;)h++;if(h>u-c){let m=n(e[o],0);for(;c<u;)t.insertBefore(n(r[c++],1),m)}else t.replaceChild(n(r[c++],1),n(e[o++],-1))}else o++}else t.removeChild(n(e[o++],-1))}return r};var Jt=function(t,e,r,n,s){var a=s in t,i=t.createDocumentFragment();i[e](t[n]("g")),i[e](t[n](""));var f=a?t[s](i,!0):i[r](!0);return f.childNodes.length<2?function o(c,l){for(var u=c[r](),p=c.childNodes||[],h=p.length,m=0;l&&m<h;m++)u[e](o(p[m],l));return u}:a?t[s]:function(o,c){return o[r](!!c)}}(document,"appendChild","cloneNode","createTextNode","importNode"),ft=Jt,Xt="".trim||function(){return String(this).replace(/^\s+|\s+/g,"")},U=Xt,Zt=j?function(t,e){var r=e.join(" ");return e.slice.call(t,0).sort(function(n,s){return r.indexOf(n.name)<=r.indexOf(s.name)?-1:1})}:function(t,e){return e.slice.call(t,0)};function ct(t,e){for(var r=e.length,n=0;n<r;)t=t.childNodes[e[n++]];return t}function J(t,e,r,n){for(var s=t.childNodes,a=s.length,i=0;i<a;){var f=s[i];switch(f.nodeType){case tt:var o=n.concat(i);Gt(f,e,r,o),J(f,e,r,o);break;case V:var c=f.textContent;if(c===g)r.shift(),e.push(W.test(t.nodeName)?lt(t,n):Kt(f,n.concat(i)));else switch(c.slice(0,2)){case"/*":if(c.slice(-2)!=="*/")break;case"\u{1F47B}":t.removeChild(f),i--,a--}break;case et:W.test(t.nodeName)&&U.call(f.textContent)===S&&(r.shift(),e.push(lt(t,n)));break}i++}}function Gt(t,e,r,n){for(var s=t.attributes,a=[],i=[],f=Zt(s,r),o=f.length,c=0;c<o;){var l=f[c++],u=l.value===g,p;if(u||1<(p=l.value.split(S)).length){var h=l.name;if(a.indexOf(h)<0){a.push(h);var m=r.shift().replace(u?/^(?:|[\S\s]*?\s)(\S+?)\s*=\s*('|")?$/:new RegExp("^(?:|[\\S\\s]*?\\s)("+h+`)\\s*=\\s*('|")[\\S\\s]*`,"i"),"$1"),N=s[m]||s[m.toLowerCase()];if(u)e.push(ut(N,n,m,null));else{for(var C=p.length-2;C--;)r.shift();e.push(ut(N,n,m,p))}}i.push(l)}}o=i.length,c=0;for(var $=0<o&&j&&!("ownerSVGElement"in t);c<o;){var y=i[c++];$&&(y.value=""),t.removeAttribute(y.name)}var T=t.nodeName;if(/^script$/i.test(T)){var _=document.createElement(T);for(o=s.length,c=0;c<o;)_.setAttributeNode(s[c++].cloneNode(!0));_.textContent=t.textContent,t.parentNode.replaceChild(_,t)}}function Kt(t,e){return{type:"any",node:t,path:e}}function ut(t,e,r,n){return{type:"attr",node:t,path:e,name:r,sparse:n}}function lt(t,e){return{type:"text",node:t,path:e}}var pt=Qt,mt=M(new k);function Yt(t,e){var r=(t.convert||q)(e),n=t.transform;n&&(r=n(r));var s=P(r,t.type);ht(s);var a=[];return J(s,a,e.slice(0),[]),{content:s,updates:function(i){for(var f=[],o=a.length,c=0,l=0;c<o;){var u=a[c++],p=ct(i,u.path);switch(u.type){case"any":f.push({fn:t.any(p,[]),sparse:!1});break;case"attr":var h=u.sparse,m=t.attribute(p,u.name,u.node);h===null?f.push({fn:m,sparse:!1}):(l+=h.length-2,f.push({fn:m,sparse:!0,values:h}));break;case"text":f.push({fn:t.text(p),sparse:!1}),p.textContent="";break}}return o+=l,function(){var N=arguments.length;if(o!==N-1)throw new Error(N-1+" values instead of "+o+`
`+e.join("${value}"));for(var C=1,$=1;C<N;){var y=f[C-$];if(y.sparse){var T=y.values,_=T[0],Q=1,Y=T.length;for($+=Y-2;Q<Y;)_+=arguments[C++]+T[Q++];y.fn(_)}else y.fn(arguments[C++])}return i}}}}function Vt(t,e){var r=mt.get(e)||mt.set(e,Yt(t,e));return r.updates(ft.call(document,r.content,!0))}var te=[];function Qt(t){var e=te,r=ht;return function(n){return e!==n&&(r=Vt(t,e=n)),r.apply(null,arguments)}}function ht(t){for(var e=t.childNodes,r=e.length;r--;){var n=e[r];n.nodeType!==1&&U.call(n.textContent).length===0&&t.removeChild(n)}}var ee=function(){"use strict";var t=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,e=/([^A-Z])([A-Z]+)/g;return function(f,o){return"ownerSVGElement"in f?n(f,o):a(f.style,!1)};function r(i,f,o){return f+"-"+o.toLowerCase()}function n(i,f){var o;return f?o=f.cloneNode(!0):(i.setAttribute("style","--hyper:style;"),o=i.getAttributeNode("style")),o.value="",i.setAttributeNode(o),a(o,!0)}function s(i){var f,o=[];for(f in i)o.push(f.replace(e,r),":",i[f],";");return o.join("")}function a(i,f){var o,c;return function(l){var u,p,h,m;switch(typeof l){case"object":if(l){if(o==="object"){if(!f&&c!==l)for(p in c)p in l||(i[p]="")}else f?i.value="":i.cssText="";u=f?{}:i;for(p in l)m=l[p],h=typeof m=="number"&&!t.test(p)?m+"px":m,!f&&/^--/.test(p)?u.setProperty(p,h):u[p]=h;o="object",f?i.value=s(c=u):c=l;break}default:c!=l&&(o="string",c=l,f?i.value=l||"":i.cssText=l||"");break}}}}(),vt=ee,gt=t=>e=>{for(let r in e){let n=r==="role"?r:`aria-${r}`,s=e[r];s==null?t.removeAttribute(n):t.setAttribute(n,s)}},X=(t,e)=>{let r,n=!0,s=document.createAttributeNS(null,e);return a=>{r!==a&&(r=a,r==null?n||(t.removeAttributeNode(s),n=!0):(s.value=a,n&&(t.setAttributeNodeNS(s),n=!1)))}},yt=({dataset:t})=>e=>{for(let r in e){let n=e[r];n==null?delete t[r]:t[r]=n}},dt=(t,e)=>{let r,n=e.slice(2);return!(e in t)&&e.toLowerCase()in t&&(n=n.toLowerCase()),s=>{let a=d(s)?s:[s,!1];r!==a[0]&&(r&&t.removeEventListener(n,r,a[1]),(r=a[0])&&t.addEventListener(n,r,a[1]))}},xt=t=>e=>{typeof e=="function"?e(t):e.current=t},Z=(t,e)=>r=>{t[e]=r},re=(t,e)=>{let r;return n=>{r!==n&&(r=n,t[e]!==n&&(n==null?(t[e]="",t.removeAttribute(e)):t[e]=n))}},ne=/^(?:form|list)$/i,ie=(t,e)=>t.ownerDocument.createTextNode(e);function z(t){return this.type=t,pt(this)}z.prototype={attribute(t,e,r){let n=this.type==="svg";switch(e){case"class":if(n)return X(t,e,n);e="className";case"props":return Z(t,e);case"aria":return gt(t);case"style":return vt(t,r,n);case"ref":return xt(t);case".dataset":return yt(t);default:return e.slice(0,1)==="."?Z(t,e.slice(1)):e.slice(0,2)==="on"?dt(t,e):e in t&&!(n||ne.test(e))?re(t,e):X(t,e,n)}},any(t,e){let{type:r}=this,n=!1,s,a=i=>{switch(typeof i){case"string":case"number":case"boolean":n?s!==i&&(s=i,e[0].textContent=i):(n=!0,s=i,e=E(t.parentNode,e,[ie(t,i)],b,t));break;case"function":a(i(t));break;case"object":case"undefined":if(i==null){n=!1,e=E(t.parentNode,e,[],b,t);break}default:if(n=!1,s=i,d(i))if(i.length===0)e.length&&(e=E(t.parentNode,e,[],b,t));else switch(typeof i[0]){case"string":case"number":case"boolean":a(String(i));break;case"function":a(i.map(oe,t));break;case"object":d(i[0])&&(i=i.concat.apply([],i));default:e=E(t.parentNode,e,i,b,t);break}else"ELEMENT_NODE"in i?e=E(t.parentNode,e,i.nodeType===11?x.call(i.childNodes):[i],b,t):"text"in i?a(String(i.text)):"any"in i?a(i.any):"html"in i?e=E(t.parentNode,e,x.call(P([].concat(i.html).join(""),r).childNodes),b,t):"length"in i&&a(x.call(i));break}};return a},text(t){let e,r=n=>{if(e!==n){e=n;let s=typeof n;s==="object"&&n?"text"in n?r(String(n.text)):"any"in n?r(n.any):"html"in n?r([].concat(n.html).join("")):"length"in n&&r(x.call(n).join("")):s==="function"?r(n(t)):t.textContent=n??""}};return r}};function oe(t){return t(this)}var{create:se,freeze:ae,keys:nr}=Object,ir=z.prototype,bt=M(new k),fe=t=>({html:Et("html",t),svg:Et("svg",t),render(e,r){let n=typeof r=="function"?r():r,s=bt.get(e)||bt.set(e,D()),a=n instanceof H?R(t,s,n):n;return a!==s.wire&&(s.wire=a,e.textContent="",e.appendChild(a.valueOf())),e}}),D=()=>({stack:[],entry:null,wire:null}),Et=(t,e)=>{let r=M(new k),n=a=>function(){return R(e,a,s.apply(null,arguments))};return s.for=(a,i)=>{let f=r.get(a)||r.set(a,se(null));return f[i]||(f[i]=n(D()))},s.node=function(){return R(e,D(),s.apply(null,arguments)).valueOf()},s;function s(){return new H(t,ce.apply(null,arguments))}},R=(t,e,{type:r,template:n,values:s})=>{let{length:a}=s;wt(t,e,s,a);let{entry:i}=e;if(!i||i.template!==n||i.type!==r){let f=new t(r);e.entry=i={type:r,template:n,tag:f,wire:at(f(n,...s))}}else i.tag(n,...s);return i.wire},wt=(t,{stack:e},r,n)=>{for(let s=0;s<n;s++){let a=r[s];a instanceof le?r[s]=R(t,e[s]||(e[s]=D()),a):d(a)?wt(t,e[s]||(e[s]=D()),a,a.length):e[s]=null}n<e.length&&e.splice(n)};ae(H);function H(t,e){this.type=t,this.template=e.shift(),this.values=e}var le=H,{render:Nt,html:v,svg:or}=fe(z);function ce(){let t=[],e=0,{length:r}=arguments;for(;e<r;)t.push(arguments[e++]);return t}var w=[],G,Ct=2;async function Tt(t,e,r){r&&(Ct=r),G=e;let n=await ue(t);Object.freeze(n),w.push(n),G(w[0])}async function A(t){let e={...w[w.length-1]};await t(e),Object.freeze(e),G(e),w.push(e),w.length>Ct&&w.shift()}function _t(t,e,r){let n=Date.now().toString(36),s=e+"."+n;t[e].push(s),t[s]=r}function St(t,e){let r=pe(e),n=t[r].indexOf(e);delete t[e],t[r].splice(n,1)}function pe(t){return t.split(".").slice(0,-1).join(".")}function At(t){return new Promise((e,r)=>{try{if(Object(t)!==t||Array.isArray(t))return t;var n={},s,a,i,f,o;for(var c in t){let l=[];if(Array.isArray(t[c]))for(let u=0;u<t[c].length;u++)l.push(t[t[c][u]]);s=n,a="",f=0;do i=c.indexOf(".",f),o=c.substring(f,i!==-1?i:void 0),s=s[a]||(s[a]=isNaN(parseInt(o))?{}:[]),a=o,f=i+1;while(i>=0);l.length>0?s[a]=l:s[a]=t[c]}e(n[""])}catch(l){r(l)}})}function ue(t){return new Promise((e,r)=>{try{var n={};function s(a,i){if(Object(a)!==a)n[i]=a;else if(Array.isArray(a)){let u=[];for(var f=0,o=a.length;f<o;f++){let p=i?i+"."+f:""+f;u.push(p),s(a[f],p)}n[i]=u}else{var c=!0;for(var l in a)c=!1,s(a[l],i?i+"."+l:l);c&&(n[i]={})}}s(t,""),e(n)}catch(a){r(a)}})}var O={count:"counter.count",todoList:"todo.list"};function Ot(t){(!t||typeof t!==Number)&&(t=1),A(async e=>{e[O.count]+=t})}function kt(t){(!t||typeof t!==Number)&&(t=1),A(async e=>{e[O.count]-=t})}var L=function(e,r){return v`
        <button onclick=${r}>${e}</button>
    `},Mt=function(e){return v`
        <div>${e}</div>
        <div>${L("Add 1",Ot)} | ${L("Subtract 1",kt)}</div>
    `};function Dt(t,e,r){return v`
        <ul>
            ${t[e].map((n,s)=>v`<li data-i=${n} onclick=${()=>{r(n,e)}}>${t[n]}</li>`)}
        </ul>
    `}function Lt(t){t===void 0&&console.error("removeTodo requires an index"),A(async e=>{St(e,t)})}function K(t,e){t===void 0&&console.error("addTodo requires a value"),A(async r=>{_t(r,e,t)})}function $t(t,e){function r(n){if(!t)return;n.keyCode===13&&t(n.target.value,e)}return v`
        <input onkeydown=${r} type="text">
    `}function jt(t,e){return v`
        <i>Click item to remove</i>
        ${Dt(t,e,Lt)}
        <div>
            ${$t(K,e)} |
            ${L("Add Todo",r=>{K(r.target.parentNode.querySelector("input").value,e)})}
        </div>
    `}var me=document.querySelector("main");async function It(t){let e=await At(t);Nt(me,v`
        <h1>Flat State</h2>
        <p>This immutable state library flattens JSON to make it easier and safer to work with. U_store is less than 1kb gzipped, and mainly helps you flatten then manage your state. The only part of the JSON object that isn't flat are arrays that have the keys to the former array values. The benifits are:</p>
        <ul>
            <li>Easier to avoid uncaught exceptions</li>
            <li>Simplier selectors</li>
            <li>Easy debugging with descriptive key value paths</li>
            <li>More efficient than accessing deeply nested data</li>
        </ul>
        <hr>
        <h2>Counter</h2>
        ${Mt(t[O.count])}
        <hr>
        <h2>Todo</h2>
        ${jt(t,O.todoList)}
        <hr>
        <h2>Flattened State</h2>
        <pre>${JSON.stringify(t,null,"	")}</pre>
        <h2>Unflattened State</h2>
        <pre>${JSON.stringify(e,null,"	")}</pre>
    `)}var he={counter:{count:0},todo:{list:["get groceries","run","walk cats"]}};Tt(he,It);})();
/*! (c) Andrea Giammarchi - ISC */
